<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Automatic DNSSEC Bootstrapping using Authenticated Signals from the Zone's Operator</title>
<meta content="Peter Thomassen" name="author">
<meta content="Nils Wisiol" name="author">
<meta content="
       This document introduces an in-band method for DNS operators to
publish arbitrary information about the zones they are authoritative
for, in an authenticated fashion and on a per-zone basis.
The mechanism allows managed DNS operators to securely announce
DNSSEC key parameters for zones under their management, including for
zones that are not currently securely delegated. 
       Whenever DS records are absent for a zone's delegation, this signal
enables the parent's registry or registrar to cryptographically
validate the CDS/CDNSKEY records found at the child's apex.
The parent can then provision DS records for the delegation without
resorting to out-of-band validation or weaker types of cross-checks
such as &quot;Accept after Delay&quot; ( ). 
       This document updates   and replaces its Section 3 with
  of this document. 
       [ Ed note: This document is being collaborated on at
 https://github.com/desec-io/draft-ietf-dnsop-dnssec-bootstrapping/ .
The authors gratefully accept pull requests. ] 
    " name="description">
<meta content="xml2rfc 3.12.2" name="generator">
<meta content="draft-ietf-dnsop-dnssec-bootstrapping-02" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.10.4
    weasyprint 54.1
-->
<link href="draft-ietf-dnsop-dnssec-bootstrapping.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">dnssec-bootstrapping</td>
<td class="right">June 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thomassen &amp; Wisiol</td>
<td class="center">Expires 24 December 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">DNSOP Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-dnsop-dnssec-bootstrapping-02</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc7344" class="eref">7344</a>, <a href="https://www.rfc-editor.org/rfc/rfc8078" class="eref">8078</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-06-22" class="published">22 June 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-12-24">24 December 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Thomassen</div>
<div class="org">deSEC, Secure Systems Engineering</div>
</div>
<div class="author">
      <div class="author-name">N. Wisiol</div>
<div class="org">deSEC, Technische Universität Berlin</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Automatic DNSSEC Bootstrapping using Authenticated Signals from the Zone's Operator</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document introduces an in-band method for DNS operators to
publish arbitrary information about the zones they are authoritative
for, in an authenticated fashion and on a per-zone basis.
The mechanism allows managed DNS operators to securely announce
DNSSEC key parameters for zones under their management, including for
zones that are not currently securely delegated.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Whenever DS records are absent for a zone's delegation, this signal
enables the parent's registry or registrar to cryptographically
validate the CDS/CDNSKEY records found at the child's apex.
The parent can then provision DS records for the delegation without
resorting to out-of-band validation or weaker types of cross-checks
such as "Accept after Delay" (<span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span>).<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document updates <span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span> and replaces its Section 3 with
<a href="#bootstrapping" class="xref">Section 3.2</a> of this document.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">[ Ed note: This document is being collaborated on at
<a href="https://github.com/desec-io/draft-ietf-dnsop-dnssec-bootstrapping/">https://github.com/desec-io/draft-ietf-dnsop-dnssec-bootstrapping/</a>.
The authors gratefully accept pull requests. ]<a href="#section-abstract-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 December 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-requirements-notation" class="xref">Requirements Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-signaling" class="xref">Signaling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-chain-of-trust" class="xref">Chain of Trust</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-signaling-names" class="xref">Signaling Names</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-bootstrapping-a-dnssec-dele" class="xref">Bootstrapping a DNSSEC Delegation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-signaling-consent-to-act-as" class="xref">Signaling Consent to Act as the Child's Signer</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-example" class="xref">Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-validating-cds-cdnskey-reco" class="xref">Validating CDS/CDNSKEY Records for DNSSEC Bootstrapping</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-example-2" class="xref">Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-triggers" class="xref">Triggers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-limitations" class="xref">Limitations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-operational-recommendations" class="xref">Operational Recommendations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-child-dns-operator" class="xref">Child DNS Operator</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-parental-agent" class="xref">Parental Agent</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-child-dns-operator-side" class="xref">Child DNS Operator-side</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-parental-agent-side" class="xref">Parental Agent-side</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-change-history-to-be-remove" class="xref">Change History (to be removed before publication)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Securing a DNS delegation for the first time requires that the
Child's DNSSEC parameters be conveyed to the Parent through some
trusted channel.
While the communication conceptually has to occur between the Parent
registry and the DNSSEC key holder, what exactly that means and how
the communication is coordinated traditionally depends on the
relationship the Child has with the Parent.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">A typical situation is that the key is held by the Child DNS
Operator; the communication thus often involes this entity.
In addition, depending on the circumstances, it may also involve the
Registrar, possibly via the Registrant (for details, see <span>[<a href="#RFC7344" class="xref">RFC7344</a>]</span>,
Appendix A).<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">As observed in <span>[<a href="#RFC7344" class="xref">RFC7344</a>]</span>, these dependencies often result in a manual
process that is susceptible to mistakes and/or errors.
In addition, due to the annoyance factor of the process, involved
parties may avoid the process of getting a DS record set published in
the first place.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">To alleviate these problems, automated provisioning of DS records has
been specified in (<span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span>).
It is based on the Parental Agent (registry or registrar) fetching
DNSSEC key parameters in the form of CDS and CDNSKEY records
(<span>[<a href="#RFC7344" class="xref">RFC7344</a>]</span>) from the Child zone's apex, and validating them
somehow.
This validation can be done using DNSSEC itself if the objective is
to update an existing DS record set (such as during key rollover).
However, when bootstrapping a DNSSEC delegation, the Child zone has
no existing DNSSEC validation path, and other means to ensure the
CDS/CDNSKEY records' legitimacy must be found.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">For lack of a comprehensive DNS-innate solution, either out-of-band
methods have been used so far to complete the chain of trust, or
cryptographic validation has been entirely dispensed with, in
exchange for weaker types of cross-checks such as "Accept after
Delay" (<span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span> Section 3.3).
<span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span> does not define an in-band validation method for enabling
DNSSEC.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This document aims to close this gap by introducing an in-band method
for DNS Operators to publish arbitrary information about the zones
they are authoritative for, in an authenticated manner and on a
per-zone basis.
The mechanism allows managed DNS Operators to securely announce
DNSSEC key parameters for zones under their management.
The Parent can then use this signal to cryptographically validate the
CDS/CDNSKEY records found at an insecure Child zone's apex, and upon
success secure the delegation.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">While applicable to the vast majority of domains, the protocol does
not support certain edge cases, such as excessively long Child zone
names, or DNSSEC bootstrapping for domains with in-bailick nameservers
only (see <a href="#limitations" class="xref">Section 3.4</a>).<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Readers are expected to be familiar with DNSSEC, including <span>[<a href="#RFC4033" class="xref">RFC4033</a>]</span>,
<span>[<a href="#RFC4034" class="xref">RFC4034</a>]</span>, <span>[<a href="#RFC4035" class="xref">RFC4035</a>]</span>, <span>[<a href="#RFC6781" class="xref">RFC6781</a>]</span>, <span>[<a href="#RFC7344" class="xref">RFC7344</a>]</span>, and <span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span>.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">This section defines the terminology used in this document.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-2">
          <dt id="section-1.1-2.1">CDS/CDNSKEY</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.2">This notation refers to CDS and/or CDNSKEY, i.e., one or both.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.3">Child</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.4">The entity on record that has the delegation of the domain from the
Parent.<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.5">Child DNS Operator</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.6">The entity that maintains and publishes the zone information for
the Child DNS.<a href="#section-1.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.7">Parent</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.8">The domain in which the Child is registered.<a href="#section-1.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.9">Parental Agent</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.10">The entity that has the authority to insert DS records into the
Parent zone on behalf of the Child.
(It could the the registry, registrar, a reseller, or some other
authorized entity.)<a href="#section-1.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.11">Signaling Domain</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.12">A hostname from the Child's NS record set, prefixed with the label
<code>_signal</code>.
There are as many Signaling Domains as there are distinct NS
targets.<a href="#section-1.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.13">Signaling Name</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.14">The labels that are prefixed to a Signaling Domain in order to
identify a Signaling Type and a Child zone's name (see
<a href="#signalingnames" class="xref">Section 2.2</a>).<a href="#section-1.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.15">Signaling Record</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.16">A DNS record located at a Signaling Name under a Signaling Domain.
Signaling Records are used by the Child DNS Operator to publish
information about the Child.<a href="#section-1.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.17">Signaling Type</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.18">A signal type identifier, such as <code>_dsboot</code> for DNSSEC bootstrapping.<a href="#section-1.1-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.19">Signaling Zone</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.20">The zone which is authoritative for a given Signaling Record.<a href="#section-1.1-2.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="requirements-notation">
<section id="section-1.2">
        <h3 id="name-requirements-notation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-requirements-notation" class="section-name selfRef">Requirements Notation</a>
        </h3>
<p id="section-1.2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>",
"<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>",
"<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and
"<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in
BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all
capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signaling">
<section id="section-2">
      <h2 id="name-signaling">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-signaling" class="section-name selfRef">Signaling</a>
      </h2>
<p id="section-2-1">This section describes the general mechanism by which a Child DNS
Operator can publish an authenticated signal about a Child zone.
Parental Agents (or any other party) can then discover and process the
signal.
Authenticity is ensured through standard DNSSEC validation.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="chain-of-trust">
<section id="section-2.1">
        <h3 id="name-chain-of-trust">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-chain-of-trust" class="section-name selfRef">Chain of Trust</a>
        </h3>
<p id="section-2.1-1">If a Child DNS Operator implements the protocol, each Signaling Zone
MUST be signed and securely delegated, i.e. have a valid DNSSEC chain
of trust.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">For example, when publishing a signal that relates to a Child zone
with NS records <code>ns1.example.net</code> and <code>ns2.example.org</code>, the Child
DNS Operator needs to ensure that a valid DNSSEC chain of trust
exists for the zone(s) that are authoritative for the Signaling
Domains <code>_signal.ns1.example.net</code> and <code>_signal.ns2.example.org</code>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signalingnames">
<section id="section-2.2">
        <h3 id="name-signaling-names">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-signaling-names" class="section-name selfRef">Signaling Names</a>
        </h3>
<p id="section-2.2-1">To publish a piece of information about the Child zone in an
authenticated fashion, the Child DNS Operator MUST publish one or
more Signaling Records at a Signaling Name under each Signaling Domain.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">Signaling Records MUST be accompanied by RRSIG records created with
the corresponding Signaling Zone's key(s).
The type and contents of these Signaling Records depend on the type of
signal.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">The Signaling Name identifies the Child and the Signaling Type.
It is identical to the Child name (but with the final root label removed),
prefixed with a label containing the Signaling Type.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bootstrapping-a-dnssec-delegation">
<section id="section-3">
      <h2 id="name-bootstrapping-a-dnssec-dele">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-bootstrapping-a-dnssec-dele" class="section-name selfRef">Bootstrapping a DNSSEC Delegation</a>
      </h2>
<p id="section-3-1">When the Child zone's CDS/CDNSKEY RRsets are used for setting up initial
trust, they need to be authenticated.
This is achieved by co-publishing the Child's CDS/CDNSKEY records as an
authenticated signal from the Child DNS Operator.
The Parent can discover and validate this signal, thus transferring
trust from the Child DNS Operator to the Child zone.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Child DNS Operators and Parental Agents who wish to use CDS/CDNSKEY
records for DNSSEC bootstrapping SHOULD support the authentication
protocol described in this section.<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="signalingrecords">
<section id="section-3.1">
        <h3 id="name-signaling-consent-to-act-as">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-signaling-consent-to-act-as" class="section-name selfRef">Signaling Consent to Act as the Child's Signer</a>
        </h3>
<p id="section-3.1-1">To confirm its willingness to act as the Child's delegated signer and
authenticate the Child's CDS/CDNSKEY RRsets, the Child DNS Operator
MUST co-publish them at the corresponding Signaling Name under each
out-of-bailiwick Signaling Domain (<a href="#signalingnames" class="xref">Section 2.2</a>).
For simplicity, the Child DNS Operator MAY also co-publish the Child's
CDS/CDNSKEY RRsets under Signaling Domains that are in bailiwick,
although those Signaling Domains are not used for validation
(<a href="#bootstrapping" class="xref">Section 3.2</a>).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Unlike the CDS/CDNSKEY records at the Child's apex, Signaling
Records MUST be signed with the corresponding Signaling Zone's
key(s).  Their contents MUST be identical to the corresponding
records published at the Child's apex.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Existing use of CDS/CDNSKEY records is specified at the Child apex
only (<span>[<a href="#RFC7344" class="xref">RFC7344</a>]</span>, Section 4.1).  This protocol extends the use of
these record types to non-apex owner names for the purpose of DNSSEC
bootstrapping.  To exclude the possibility of semantic collision,
there MUST NOT be a zone cut at a Signaling Name.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div id="example">
<section id="section-3.1.1">
          <h4 id="name-example">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-example" class="section-name selfRef">Example</a>
          </h4>
<p id="section-3.1.1-1">For the purposes of bootstrapping the Child zone <code>example.co.uk</code> with NS
records <code>ns1.example.net</code>, <code>ns2.example.org</code>, and <code>ns3.example.co.uk</code>,
the required Signaling Domains are <code>_signal.ns1.example.net</code> and
<code>_signal.ns2.example.org</code>.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">In the zones containing these domains, the Child DNS Operator
authenticates the CDS/CDNSKEY records found at the Child's apex by
co-publishing them at the names:<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.1-3">
<pre>_dsboot.example.co.uk._signal.ns1.example.net
_dsboot.example.co.uk._signal.ns2.example.org
</pre><a href="#section-3.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-3.1.1-4">The records are accompanied by RRSIG records created using the key(s)
of the respective Signaling Zone.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1.1-5">Publication of Signaling Records under the in-bailiwick domain
<code>_signal.ns3.example.co.uk</code> is not required.<a href="#section-3.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="bootstrapping">
<section id="section-3.2">
        <h3 id="name-validating-cds-cdnskey-reco">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-validating-cds-cdnskey-reco" class="section-name selfRef">Validating CDS/CDNSKEY Records for DNSSEC Bootstrapping</a>
        </h3>
<p id="section-3.2-1">This section replaces Section 3 of <span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">To validate a Child's CDS/CDNSKEY RRset for DNSSEC bootstrapping, the
Parental Agent, knowing both the Child zone name and its NS
hostnames, MUST execute the following steps:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3">
<li id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">verify that the Child is not currently securely delegated and that at
least one of its nameservers is out of bailiwick;<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">query the CDS/CDNSKEY records at the Child zone apex directly from
each of the authoritative servers as determined by the delegation's
NS record set (without caching);<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-3.3">
            <p id="section-3.2-3.3.1">query the CDS/CDNSKEY records located at the Signaling Name under
each out-of-bailiwick Signaling Domain using a trusted DNS resolver
and enforce DNSSEC validation;<a href="#section-3.2-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.2-3.4">
            <p id="section-3.2-3.4.1">check (separately by record type) that all record sets retrieved
in Steps 2 and 3 have equal contents;<a href="#section-3.2-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.2-4">If the above steps succeed without error, the CDS/CDNSKEY records are
successfully validated, and the Parental Agent can proceed with the
publication of the DS record set under the precautions described in
<span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span>, Section 5.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">If, however, an error condition occurs, in particular:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">
            <p id="section-3.2-6.1.1">in Step 1: the Child is already securely delegated or has in-bailiwick
nameservers only;<a href="#section-3.2-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.2">
            <p id="section-3.2-6.2.1">in Step 2: any failure during the retrieval of the CDS/CDNSKEY
records located at the Child apex from any of the authoritative
nameservers;<a href="#section-3.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.3">
            <p id="section-3.2-6.3.1">in Step 3: any failure to retrieve the CDS/CDNSKEY RRsets located
at the Signaling Name under any Signaling Domain, including failure
of DNSSEC validation, or unauthenticated data (AD bit not set);<a href="#section-3.2-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-6.4">
            <p id="section-3.2-6.4.1">in Step 4: inconsistent responses (for at least one of the types),
including a record set that is empty in one of Steps 2 or 3, but
non-empty in the other;<a href="#section-3.2-6.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-7">the Parental Agent MUST abort the procedure.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<div id="example-1">
<section id="section-3.2.1">
          <h4 id="name-example-2">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-example-2" class="section-name selfRef">Example</a>
          </h4>
<p id="section-3.2.1-1">To verify the CDS/CDNSKEY records for the Child <code>example.co.uk</code>, the
Parental Agent (assuming that the Child delegation's NS records are
<code>ns1.example.net</code>, <code>ns2.example.org</code>, and <code>ns3.example.co.uk</code>)<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2.1-2">
<li id="section-3.2.1-2.1">
              <p id="section-3.2.1-2.1.1">checks that the Child domain is not yet securely delegated;<a href="#section-3.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-2.2">
              <p id="section-3.2.1-2.2.1">queries CDS/CDNSKEY records for <code>example.co.uk</code> directly from
<code>ns1.example.net</code>, <code>ns2.example.org</code>, and <code>ns3.example.co.uk</code>
(without caching);<a href="#section-3.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-2.3">
              <p id="section-3.2.1-2.3.1">queries and validates the CDS/CDNSKEY records located at (see
<a href="#signalingnames" class="xref">Section 2.2</a>; <code>ns3.example.co.uk</code> is ignored because it is in
bailiwick)<a href="#section-3.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<div class="alignLeft art-text artwork" id="section-3.2.1-3">
<pre>_dsboot.example.co.uk._signal.ns1.example.net
_dsboot.example.co.uk._signal.ns2.example.org
</pre><a href="#section-3.2.1-3" class="pilcrow">¶</a>
</div>
<ol start="4" type="1" class="normal type-1" id="section-3.2.1-4">
<li id="section-3.2.1-4.1">checks that the CDS/CDNSKEY record sets retrieved in Steps 2
and 3 agree across responses.<a href="#section-3.2.1-4.1" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.2.1-5">If all these steps succeed, the Parental Agent can proceed to publish
a DS record set as indicated by the validated CDS/CDNSKEY records.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
<p id="section-3.2.1-6">The Parental Agent does not use in-bailiwick Signaling Names during
validation because they cannot have a pre-established chain of trust at
bootstrapping time, so are not useful for bootstrapping.
Consequently, if all NS hostnames are in bailiwick, validation cannot be
completed, and DS records are not published.<a href="#section-3.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="triggers">
<section id="section-3.3">
        <h3 id="name-triggers">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-triggers" class="section-name selfRef">Triggers</a>
        </h3>
<p id="section-3.3-1">Parental Agents SHOULD trigger the procedure described in
<a href="#bootstrapping" class="xref">Section 3.2</a> once one of the following conditions is fulfilled:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.1">
            <p id="section-3.3-2.1.1">The Parental Agent receives a new or updated NS record set for a
Child;<a href="#section-3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-2.2">
            <p id="section-3.3-2.2.1">The Parental Agent encounters a Signaling Record during a proactive,
opportunistic scan (e.g. daily queries for the Signaling Records of
some or all of its delegations);<a href="#section-3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-2.3">
            <p id="section-3.3-2.3.1">Any other condition as deemed appropriate by local policy.<a href="#section-3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.3-3">Most types of discovery (such as daily scans of delegations) are based
directly on the delegation's NS record set.
In this case, these NS names can be used as is by the bootstrapping
algorithm (<a href="#bootstrapping" class="xref">Section 3.2</a>) for querying Signaling Records.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">Some discovery methods, however, do not imply reliable knowledge of the
Child's NS record set.
For example, when discovering Signaling Names by performing an NSEC
walk or zone transfer of a Signaling Zone, the Parental Agent MUST NOT
assume that the nameserver(s) under whose Signaling Domain(s) a
Signaling Name appears is in fact authoritative for the corresponding
Child.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">In this case (and in other cases alike where some list of
"bootstrappable domains" is retrieved elsewhere), the Parental Agent
MUST ascertain that the Child's delegation actually contains the
nameserver hostname seen during discovery, and ensure that Signaling
Record queries are only made against the proper set of nameservers as
listed in the Child's delegation from the Parent.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="limitations">
<section id="section-3.4">
        <h3 id="name-limitations">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-limitations" class="section-name selfRef">Limitations</a>
        </h3>
<p id="section-3.4-1">As a consequence of Step 3 in <a href="#bootstrapping" class="xref">Section 3.2</a>, DS bootstrapping does
not work for fully in-bailiwick delegations, as no pre-existing chain of
trust to the Child domain is available during bootstrapping.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">The protocol is further restricted by the fact that the fully
qualified Signaling Names fit within the general limits that apply to
DNS names (such as their length and label count).<a href="#section-3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="operational-recommendations">
<section id="section-4">
      <h2 id="name-operational-recommendations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-operational-recommendations" class="section-name selfRef">Operational Recommendations</a>
      </h2>
<div id="child-dns-operator">
<section id="section-4.1">
        <h3 id="name-child-dns-operator">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-child-dns-operator" class="section-name selfRef">Child DNS Operator</a>
        </h3>
<p id="section-4.1-1">Signaling Domains SHOULD be delegated as zones of their own, so
that the Signaling Zone's apex coincides with the Signaling
Domain (such as <code>_signal.ns1.example.net</code>).
While it is permissible for the Signaling Domain to be contained
in a Signaling Zone of fewer labels (such as <code>example.net</code>), a
zone cut ensures that bootstrapping activities do not require
modifications of the zone containing the nameserver hostname.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">To keep the size of the Signaling Zones minimal and bulk processing
efficient (such as via zone transfers), Child DNS Operators SHOULD
remove Signaling Records which are found to have been acted upon.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="parental-agent">
<section id="section-4.2">
        <h3 id="name-parental-agent">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-parental-agent" class="section-name selfRef">Parental Agent</a>
        </h3>
<p id="section-4.2-1">It is RECOMMENDED to perform queries within Signaling Domains
(<a href="#bootstrapping" class="xref">Section 3.2</a>) with an (initially) cold resolver cache or to limit
the TTL of cached records to the interval between scans, as to retrieve
the most current information regardless of TTL.
(When a batch job is used to attempt bootstrapping for a large number
of delegations, the cache does not need to get cleared in between.)<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="section-5">
      <h2 id="name-implementation-status">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-5-1"><strong>Note to the RFC Editor</strong>: please remove this entire section before publication.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="child-dns-operator-side">
<section id="section-5.1">
        <h3 id="name-child-dns-operator-side">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-child-dns-operator-side" class="section-name selfRef">Child DNS Operator-side</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-5.1-1.1">
            <p id="section-5.1-1.1.1">Knot DNS supports manual creation of non-apex CDS/CDNSKEY records.<a href="#section-5.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.2">
            <p id="section-5.1-1.2.1">PowerDNS supports manual creation of non-apex CDS/CDNSKEY records.<a href="#section-5.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.3">
            <p id="section-5.1-1.3.1">Proof-of-concept Signaling Domains with several thousand Signaling
Names exist at <code>_signal.ns1.desec.io</code> and <code>_signal.ns2.desec.org</code>.<a href="#section-5.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.4">
            <p id="section-5.1-1.4.1">Another DNS operator has implemented the protocol (synthesizing
Signaling Records for a significant number of domains).<a href="#section-5.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.1-1.5">
            <p id="section-5.1-1.5.1">The authors are planning to develop a tool for automatic generation
of signaling records.<a href="#section-5.1-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="parental-agent-side">
<section id="section-5.2">
        <h3 id="name-parental-agent-side">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-parental-agent-side" class="section-name selfRef">Parental Agent-side</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-5.2-1.1">
            <p id="section-5.2-1.1.1">A tool to retrieve and process Signaling Records for bootstrapping
purposes, either directly or via zone walking, is available at
<a href="https://github.com/desec-io/dsbootstrap">https://github.com/desec-io/dsbootstrap</a>.
The tool outputs the validated DS records which then can be added
to the Parent zone.<a href="#section-5.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-1.2">
            <p id="section-5.2-1.2.1">Some registries/registrars (e.g. .cl, GoDaddy) are working on
implementations of the protocol.<a href="#section-5.2-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">The protocol adds authentication to the CDS/CDNSKEY-based
bootstrapping concept of <span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span>, while removing nothing.
Its security level is therefore strictly higher than that of existing
approaches described in that document (e.g. "Accept after Delay").
Apart from this general improvement, the same Security Considerations
apply as in <span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The level of rigor in <a href="#bootstrapping" class="xref">Section 3.2</a> is needed to prevent
publication of a half-baked DS RRset (authorized only under a subset
of NS hostnames).
This ensures, for example, that an operator in a multi-homed setup
cannot enable DNSSEC unless all other operators agree.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">Because the parents of a Signaling Domain (such as the corresponding TLD
registry) are in control of its chain of trust, they are also able to
undermine the signal's authenticity.
To mitigate this risk, it is RECOMMENDED to increase the effort required
to collude for taking control of all Signaling Domains, by diversifying
the path from the root to each nameserver.
This is best achieved by using different and independently operated TLDs
for each one.
(TLD-independent NS hostnames are advisable anyways in DNS operations,
in order to prevent the TLD from becoming a single point of failure.)
Furthermore, as the Child DNS Operator has authoritative knowledge of
the Child's CDS/CDNSKEY records, it can readily detect fraudulent
provisioning of DS records.<a href="#section-6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">Per <span>[<a href="#RFC8552" class="xref">RFC8552</a>]</span>, IANA is requested to add the following entries to the
"Underscored and Globally Scoped DNS Node Names" registry:<a href="#section-7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7-2">
<pre>+---------+------------+-----------------------------------------+
| RR Type | _NODE NAME | Reference                               |
+---------+------------+-----------------------------------------+
| CDS     | _signal    | [draft-ietf-dnsop-dnssec-bootstrapping] |
| CDNSKEY | _signal    | [draft-ietf-dnsop-dnssec-bootstrapping] |
+---------+------------+-----------------------------------------+
</pre><a href="#section-7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">Thanks to Brian Dickson, Ond&amp;#345;ej Caletka, John R. Levine, Christian
Elmerot, Oli Schacher, Donald Eastlake, and Libor Peltan for reviewing
draft proposals and offering comments and suggestions.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Thanks also to Steve Crocker, Hugo Salgado, and Ulrich Wisser for
early-stage brainstorming.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-normative-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4033">[RFC4033]</dt>
      <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4033">https://www.rfc-editor.org/info/rfc4033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4034">[RFC4034]</dt>
      <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"Resource Records for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4034</span>, <span class="seriesInfo">DOI 10.17487/RFC4034</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4034">https://www.rfc-editor.org/info/rfc4034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4035">[RFC4035]</dt>
      <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"Protocol Modifications for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4035</span>, <span class="seriesInfo">DOI 10.17487/RFC4035</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4035">https://www.rfc-editor.org/info/rfc4035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6781">[RFC6781]</dt>
      <dd>
<span class="refAuthor">Kolkman, O.</span>, <span class="refAuthor">Mekking, W.</span>, and <span class="refAuthor">R. Gieben</span>, <span class="refTitle">"DNSSEC Operational Practices, Version 2"</span>, <span class="seriesInfo">RFC 6781</span>, <span class="seriesInfo">DOI 10.17487/RFC6781</span>, <time datetime="2012-12" class="refDate">December 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6781">https://www.rfc-editor.org/info/rfc6781</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7344">[RFC7344]</dt>
      <dd>
<span class="refAuthor">Kumari, W.</span>, <span class="refAuthor">Gudmundsson, O.</span>, and <span class="refAuthor">G. Barwood</span>, <span class="refTitle">"Automating DNSSEC Delegation Trust Maintenance"</span>, <span class="seriesInfo">RFC 7344</span>, <span class="seriesInfo">DOI 10.17487/RFC7344</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7344">https://www.rfc-editor.org/info/rfc7344</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8078">[RFC8078]</dt>
      <dd>
<span class="refAuthor">Gudmundsson, O.</span> and <span class="refAuthor">P. Wouters</span>, <span class="refTitle">"Managing DS Records from the Parent via CDS/CDNSKEY"</span>, <span class="seriesInfo">RFC 8078</span>, <span class="seriesInfo">DOI 10.17487/RFC8078</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8078">https://www.rfc-editor.org/info/rfc8078</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8552">[RFC8552]</dt>
    <dd>
<span class="refAuthor">Crocker, D.</span>, <span class="refTitle">"Scoped Interpretation of DNS Resource Records through "Underscored" Naming of Attribute Leaves"</span>, <span class="seriesInfo">BCP 222</span>, <span class="seriesInfo">RFC 8552</span>, <span class="seriesInfo">DOI 10.17487/RFC8552</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8552">https://www.rfc-editor.org/info/rfc8552</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="change-history-to-be-removed-before-publication">
<section id="appendix-A">
      <h2 id="name-change-history-to-be-remove">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-change-history-to-be-remove" class="section-name selfRef">Change History (to be removed before publication)</a>
      </h2>
<ul class="normal">
<li class="normal" id="appendix-A-1.1">draft-ietf-dnsop-dnssec-bootstrapping-02<a href="#appendix-A-1.1" class="pilcrow">¶</a>
</li>
      </ul>
<blockquote id="appendix-A-2">
        <p id="appendix-A-2.1">Editorial changes.<a href="#appendix-A-2.1" class="pilcrow">¶</a></p>
</blockquote>
<ul class="normal">
<li class="normal" id="appendix-A-3.1">draft-ietf-dnsop-dnssec-bootstrapping-01<a href="#appendix-A-3.1" class="pilcrow">¶</a>
</li>
      </ul>
<blockquote id="appendix-A-4">
        <p id="appendix-A-4.1">Allow bootstrapping when some (not all) NS hostnames are in bailiwick.<a href="#appendix-A-4.1" class="pilcrow">¶</a></p>
<p id="appendix-A-4.2">Clarified Operational Recommendations according to operator feedback.<a href="#appendix-A-4.2" class="pilcrow">¶</a></p>
<p id="appendix-A-4.3">Turn loose Security Considerations points into coherent text.<a href="#appendix-A-4.3" class="pilcrow">¶</a></p>
<p id="appendix-A-4.4">Do no longer suggest NSEC-walking Signaling Domains.
  (It does not work well due to the Signaling Type prefix. What's more,
  it's unclear who would do this: Parents know there delegations and can
  do a targeted scan; others are not interested.)<a href="#appendix-A-4.4" class="pilcrow">¶</a></p>
<p id="appendix-A-4.5">Editorial changes.<a href="#appendix-A-4.5" class="pilcrow">¶</a></p>
<p id="appendix-A-4.6">Added IANA request.<a href="#appendix-A-4.6" class="pilcrow">¶</a></p>
<p id="appendix-A-4.7">Introduced Signaling Type prefix (<code>_dsboot</code>), renamed Signaling Name
  infix from <code>_dsauth</code> to <code>_signal</code>.<a href="#appendix-A-4.7" class="pilcrow">¶</a></p>
</blockquote>
<ul class="normal">
<li class="normal" id="appendix-A-5.1">draft-ietf-dnsop-dnssec-bootstrapping-00<a href="#appendix-A-5.1" class="pilcrow">¶</a>
</li>
      </ul>
<blockquote id="appendix-A-6">
        <p id="appendix-A-6.1">Editorial changes.<a href="#appendix-A-6.1" class="pilcrow">¶</a></p>
</blockquote>
<ul class="normal">
<li class="normal" id="appendix-A-7.1">draft-thomassen-dnsop-dnssec-bootstrapping-03<a href="#appendix-A-7.1" class="pilcrow">¶</a>
</li>
      </ul>
<blockquote id="appendix-A-8">
        <p id="appendix-A-8.1">Clarified importance of record cleanup by moving paragraph up.<a href="#appendix-A-8.1" class="pilcrow">¶</a></p>
<p id="appendix-A-8.2">Pointed out limitations.<a href="#appendix-A-8.2" class="pilcrow">¶</a></p>
<p id="appendix-A-8.3">Replace <span>[<a href="#RFC8078" class="xref">RFC8078</a>]</span> Section 3 with our <a href="#bootstrapping" class="xref">Section 3.2</a>.<a href="#appendix-A-8.3" class="pilcrow">¶</a></p>
<p id="appendix-A-8.4">Changed <code>_boot</code> label to <code>_dsauth</code>.<a href="#appendix-A-8.4" class="pilcrow">¶</a></p>
<p id="appendix-A-8.5">Removed hashing of Child name components in Signaling Names.<a href="#appendix-A-8.5" class="pilcrow">¶</a></p>
<p id="appendix-A-8.6">Editorial changes.<a href="#appendix-A-8.6" class="pilcrow">¶</a></p>
</blockquote>
<ul class="normal">
<li class="normal" id="appendix-A-9.1">draft-thomassen-dnsop-dnssec-bootstrapping-02<a href="#appendix-A-9.1" class="pilcrow">¶</a>
</li>
      </ul>
<blockquote id="appendix-A-10">
        <p id="appendix-A-10.1">Reframed as an authentication mechanism for RFC 8078.<a href="#appendix-A-10.1" class="pilcrow">¶</a></p>
<p id="appendix-A-10.2">Removed multi-signer use case (focus on RFC 8078 authentication).<a href="#appendix-A-10.2" class="pilcrow">¶</a></p>
<p id="appendix-A-10.3">Triggers need to fetch NS records (if not implicit from context).<a href="#appendix-A-10.3" class="pilcrow">¶</a></p>
<p id="appendix-A-10.4">Improved title.<a href="#appendix-A-10.4" class="pilcrow">¶</a></p>
<p id="appendix-A-10.5">Recognized that hash collisions are dealt with by Child apex check.<a href="#appendix-A-10.5" class="pilcrow">¶</a></p>
</blockquote>
<ul class="normal">
<li class="normal" id="appendix-A-11.1">draft-thomassen-dnsop-dnssec-bootstrapping-01<a href="#appendix-A-11.1" class="pilcrow">¶</a>
</li>
      </ul>
<blockquote id="appendix-A-12">
        <p id="appendix-A-12.1">Add section on Triggers.<a href="#appendix-A-12.1" class="pilcrow">¶</a></p>
<p id="appendix-A-12.2">Clarified title.<a href="#appendix-A-12.2" class="pilcrow">¶</a></p>
<p id="appendix-A-12.3">Improved abstract.<a href="#appendix-A-12.3" class="pilcrow">¶</a></p>
<p id="appendix-A-12.4">Require CDS/CDNSKEY records at the Child.<a href="#appendix-A-12.4" class="pilcrow">¶</a></p>
<p id="appendix-A-12.5">Reworked Signaling Name scheme.<a href="#appendix-A-12.5" class="pilcrow">¶</a></p>
<p id="appendix-A-12.6">Recommend using cold cache for consumption.<a href="#appendix-A-12.6" class="pilcrow">¶</a></p>
<p id="appendix-A-12.7">Updated terminology (replace "Bootstrapping" by "Signaling").<a href="#appendix-A-12.7" class="pilcrow">¶</a></p>
<p id="appendix-A-12.8">Added NSEC recommendation for Bootstrapping Zones.<a href="#appendix-A-12.8" class="pilcrow">¶</a></p>
<p id="appendix-A-12.9">Added multi-signer use case.<a href="#appendix-A-12.9" class="pilcrow">¶</a></p>
<p id="appendix-A-12.10">Editorial changes.<a href="#appendix-A-12.10" class="pilcrow">¶</a></p>
</blockquote>
<ul class="normal">
<li class="normal" id="appendix-A-13.1">draft-thomassen-dnsop-dnssec-bootstrapping-00<a href="#appendix-A-13.1" class="pilcrow">¶</a>
</li>
      </ul>
<blockquote id="appendix-A-14">
        <p id="appendix-A-14.1">Initial public draft.<a href="#appendix-A-14.1" class="pilcrow">¶</a></p>
</blockquote>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Peter Thomassen</span></div>
<div dir="auto" class="left"><span class="org">deSEC, Secure Systems Engineering</span></div>
<div dir="auto" class="left"><span class="locality">Berlin</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:peter@desec.io" class="email">peter@desec.io</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nils Wisiol</span></div>
<div dir="auto" class="left"><span class="org">deSEC, Technische Universität Berlin</span></div>
<div dir="auto" class="left"><span class="locality">Berlin</span></div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:nils@desec.io" class="email">nils@desec.io</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
